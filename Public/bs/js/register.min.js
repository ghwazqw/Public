$(document).ready(function(){function trim(a){return a.replace(/^\s*|\s*$/gi,"")}function getUserName(){return trim($("#Username").val())}function txtcode(){return trim($("#txtcode").val())}function txtpwd(){return trim($("#textPwd").val())}function Email(){return trim($("#Email").val())}$("#Email").blur(function(){if(!Email()){$("#Email").attr("placeholder","此项为必填");$("#Email").css("border","1px solid #ff0000");$("#Email_chck").show();return!1}var a=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;if(!a.test(Email())){$("#Email").attr("placeholder","邮箱填写错误");$("#Email").css("border","1px solid #ff0000");$("#Email_chck").show();$("#Email_chck").html("请填写正确的邮箱！");$("#Email_ok").hide();return!1}$.ajax({type:"POST",url:"/home/Quser/Forgot_Password",data:{email:Email()},success:function(a){$("#chkmsg").css("color","#ff0000");if("Error"!=a){$("#Email").css("border","1px solid #ff0000");$("#Email_chck").show();$("#Email_chck").html("邮箱已经被注册");$("#Email_ok").hide();return!1}$("#Email").css("border","1px solid #0785e9");$("#Email_chck").hide();$("#Email_ok").show()},complete:function(){$("#Submit").html("提交");$("#Submit").prop("disabled",!1)},timeout:6e4,error:function(a,b,c){alert("响应超时，请稍候重试"+c)}})});$("#Username").blur(function(){if(!getUserName()){$("#Username").attr("placeholder","此项为必填");$("#Username").css("border","1px solid #ff0000");$("#user_chck").show();return!1}if(getUserName().length<6||getUserName().length>20){$("#Username").css("border","1px solid #ff0000");$("#user_chck").html("请输入6-20位字母或数字的组合。");$("#user_chck").show();$("#user_ok").hide();return!1}$.ajax({type:"POST",url:"/home/Quser/user_reg",data:{Username:getUserName(),action:1},success:function(result,state){var getResult=eval("("+result+")");if(1!=getResult.user_callback){$("#Username").css("border","1px solid #ff0000");$("#user_chck").html("用户被占用。");$("#user_chck").show();$("#user_ok").hide();$("#Submit").prop("disabled",!0);return!1}$("#Username").css("border","1px solid #0785e9");$("#user_chck").hide();$("#user_ok").show();$("#Submit").prop("disabled",!1)},timeout:8e3,error:function(a,b){alert("出错，具体为"+b)}})});$("#textPwd").blur(function(){var a=/^\w{6,}$/,b=trim($("#textPwd").val());if(""==b){$("#textPwd").attr("placeholder","此项为必填");$("#textPwd").css("border","1px solid #ff0000");$("#pass_chck").show();$("#pass_ok").hide();return!1}if(!a.test(b)){$("#pass_chck").show();$("#pass_ok").hide();$("#pass_chck").html("请输入6-20位字母/数字/符号的组合。");return!1}$("#textPwd").css("border","1px solid #0785e9");$("#pass_chck").hide();$("#pass_ok").show()});$("#rePwd").blur(function(){var a=trim($("#rePwd").val()),b=trim($("#textPwd").val());if(""==a){$("#rePwd").attr("placeholder","此项为必填");$("#rePwd").css("border","1px solid #ff0000");$("#repass_chck").show();$("#repass_ok").hide();return!1}if(b!=a){$("#repass_ok").hide();$("#repass_chck").html("两次输入的密码不一致");$("#repass_chck").show();return!1}$("#repass_chck").hide();$("#rePwd").css("border","1px solid #0785e9");$("#repass_ok").show()});$("#txtcode").blur(function(){var txtcode=trim($("#txtcode").val());if(""==txtcode){$("#txtcode").attr("placeholder","此项为必填");$("#txtcode").css("border","1px solid #ff0000");$("#code_chck").show();$("#code_ok").hide();return!1}$.ajax({type:"POST",url:"/home/Quser/user_reg",data:{txtcode:txtcode,action:2},success:function(data,state){var gettxtcode=eval("("+data+")");if(0==gettxtcode.txt_callback){$("#txtcode").css("border","1px solid #ff0000");$("#Info").html(gettxtcode.txt_info);$("#code_chck").show();$("#code_ok").hide();return!1}$("#code_chck").hide();$("#txtcode").css("border","1px solid #0785e9");$("#Info").hide();$("#code_ok").show()}})});$("#Submit").click(function(){if(getUserName()&&txtcode()&&Email()){$("#Submit").html("正在提交...");$("#Submit").prop("disabled",!0);$.ajax({type:"POST",url:"/home/Quser/user_reg",data:{Username:getUserName(),action:3,textPwd:txtpwd(),user_yx:Email()},success:function(){window.location.href="/?a=user_ok&c=Quser"},complete:function(){$("#Submit").html("提交");$("#Submit").prop("disabled",!1)},timeout:8e3,error:function(a,b){alert("出错，具体为"+b)}})}else alert("所有信息必须输入")})});